# GitHubリポジトリ検索アプリケーション 要件定義書

## 1. 機能要件

### 1.1 ユーザーストーリー

#### Epic: GitHubリポジトリ検索・閲覧機能

**US-001: リポジトリ検索**
```
As a 開発者
I want to GitHub リポジトリを文字列で検索できる
So that 必要なプロジェクトを効率的に見つけることができる
```

**受け入れ条件:**
- 検索フォームにキーワードを入力できる
- 検索実行時にGitHub APIが呼び出される
- 検索結果が表示される
- 空文字検索時は何も実行されない
- 検索中はローディング表示がされる

**US-002: 検索結果表示**
```
As a 開発者
I want to 検索結果をカード形式で一覧表示できる
So that リポジトリの概要を素早く把握できる
```

**受け入れ条件:**
- 検索結果はカードレイアウトで表示される
- 各カードには以下の情報が表示される:
  - リポジトリ名
  - オーナーアイコン
  - プロジェクト言語
  - Star 数
  - Watcher 数
  - Fork 数
  - Issue 数
- カードはクリック可能である
- レスポンシブ対応（モバイル・タブレット・デスクトップ）

**US-003: 無限スクロール**
```
As a 開発者
I want to スクロールで追加の検索結果を読み込める
So that 大量の検索結果を効率的に閲覧できる
```

**受け入れ条件:**
- ページ下部までスクロール時に次のページが自動読み込みされる
- 読み込み中は適切なローディング表示がされる
- 全ての結果を読み込み完了時は「すべての結果を表示しました」等の表示
- GitHub APIの制限（1000件）に達した場合の適切な処理

**US-004: リポジトリ詳細表示**
```
As a 開発者
I want to 選択したリポジトリの詳細情報を確認できる
So that リポジトリについて深く理解できる
```

**受け入れ条件:**
- カードクリック時に詳細画面に遷移する
- 詳細画面には以下の情報を表示:
  - 基本情報（名前、説明、URL、作成日等）
  - オーナーアイコン
  - 統計情報（スター、フォーク、Issue数、Watcher数）
  - 言語構成
  - 最新のコミット情報
- 検索画面に戻るボタンがある
- URLでの直接アクセスが可能

### 1.2 画面仕様

#### 1.2.1 検索一覧画面 (`/`)

**レイアウト構成:**
```
+----------------------------------+
|            ヘッダー               |
+----------------------------------+
|                                  |
|         検索フォーム              |
|     [検索ボックス] [検索ボタン]    |
|                                  |
+----------------------------------+
|                                  |
|        検索結果エリア             |
|    +-------------------------+   |
|    |   リポジトリカード       |   |
|    +-------------------------+   |
|    |   リポジトリカード       |   |
|    +-------------------------+   |
|    |         ...             |   |
|    +-------------------------+   |
|                                  |
+----------------------------------+
|        ローディング表示           |
+----------------------------------+
```

**コンポーネント仕様:**

**SearchForm コンポーネント**
- Input フィールド（HeroUI Input）
- 検索ボタン（HeroUI Button）
- Enterキーでの検索実行
- 入力値のバリデーション

**RepositoryCard コンポーネント**
- カードコンテナ（HeroUI Card）
- リポジトリ情報の表示
- ホバー効果
- クリックイベント

**InfiniteScroll コンポーネント**
- Intersection Observer API 使用
- ローディング状態管理
- エラーハンドリング

#### 1.2.2 詳細画面 (`/repository/[owner]/[name]`)

**レイアウト構成:**
```
+----------------------------------+
|       [← 戻る] ヘッダー            |
+----------------------------------+
|                                  |
|       リポジトリタイトル           |
|       owner/repository-name       |
|                                  |
+----------------------------------+
|                                  |
|        基本情報セクション          |
|                                  |
+----------------------------------+
|                                  |
|        統計情報セクション          |
|                                  |
+----------------------------------+
|                                  |
|        詳細情報セクション          |
|                                  |
+----------------------------------+
```

### 1.3 技術要件（追加）

#### 1.3.1 アーキテクチャ要件
- **Next.js App Router**: 必須使用、Pages Routerは使用しない
  - app/ ディレクトリベースの構成
  - Server Components と Client Components の適切な使い分け
  - Route Groups、Parallel Routes、Intercepting Routes の活用検討

- **テストコード**: 包括的なテストスイートの実装
  - ユニットテスト：全関数・コンポーネントをカバー
  - 統合テスト：API連携、状態管理の動作確認
  - E2Eテスト：主要ユーザーフローの自動テスト

#### 1.3.2 API仕様

**GitHub REST API エンドポイント**
- エンドポイント: `GET https://api.github.com/search/repositories`
- パラメータ:
  - `q`: 検索クエリ（必須）
  - `sort`: ソート順（stars, forks, updated）
  - `order`: 昇順・降順（asc, desc）
  - `per_page`: ページあたりの件数（max: 100）
  - `page`: ページ番号

**詳細取得API**
- エンドポイント: `GET https://api.github.com/repos/{owner}/{repo}`
- レスポンス: リポジトリの詳細情報

#### 1.3.3 Next.js App Router API Routes

**検索エンドポイント**
```
GET /api/repositories/search/route.ts
Query Parameters:
- q: string (required)
- page: number (default: 1)
- per_page: number (default: 30, max: 100)

Response:
{
  "items": Repository[],
  "total_count": number,
  "incomplete_results": boolean,
  "has_next_page": boolean
}
```

**詳細取得エンドポイント**
```
GET /api/repositories/[owner]/[name]/route.ts

Response: Repository (詳細版)
```

## 2. 非機能要件

### 2.1 パフォーマンス要件

**レスポンス時間**
- 初回ページロード: 3秒以内
- 検索実行: 2秒以内
- 詳細画面表示: 1.5秒以内
- 無限スクロール読み込み: 1秒以内

**スループット**
- 同時ユーザー数: 100人まで対応
- 1分間あたりの検索リクエスト: 500件まで

**リソース使用量**
- JavaScript バンドルサイズ: 500KB 以下
- 初回ページロード時のデータ転送量: 2MB 以下
- メモリ使用量: 100MB 以下（ブラウザ）

### 2.2 可用性要件

**稼働率**
- 目標稼働率: 99.5%
- 計画停止時間: 月4時間以内

**障害対応**
- エラー検知時間: 5分以内
- 復旧時間: 30分以内（軽微な障害）

### 2.3 拡張性要件

**ユーザー数拡張**
- 将来的に1000人同時利用まで対応可能な設計

**機能拡張**
- 認証機能の追加対応
- 他のGitプラットフォーム（GitLab等）への拡張可能性
- モバイルアプリ化への対応可能性

### 2.4 セキュリティ要件

**データ保護**
- 個人情報は保存しない
- GitHub APIトークンの適切な管理
- XSS, CSRF攻撃への対策

**アクセス制御**
- 公開リポジトリのみを検索対象とする
- 適切なCORS設定
- レート制限の実装

## 3. 制約事項

### 3.1 技術的制約

**GitHub API制約**
- 未認証リクエスト: 60リクエスト/時間
- 検索結果: 最大1000件まで
- レスポンスサイズ制限

**ブラウザサポート**
- モダンブラウザのみサポート
- IE11以下は対象外
- JavaScript必須

**ホスティング制約**
- Vercelの無料プランを想定
- サーバーレス関数の実行時間制限

### 3.2 ビジネス制約

**予算制限**
- 開発・運用コストを最小限に抑制
- 外部サービスは無料プランを活用

**開発リソース**
- 個人開発プロジェクト
- 開発期間: 2-3週間程度

### 3.3 法的制約

**ライセンス**
- オープンソースライブラリの適切な利用
- GitHub利用規約の遵守

**プライバシー**
- 個人情報保護法への準拠
- Cookie利用時の適切な通知

## 4. 前提条件

### 4.1 技術的前提

**開発環境**
- Node.js 18以上
- pnpm または npm
- Git

**デプロイ環境**
- Vercel アカウント
- カスタムドメイン（optional）

### 4.2 外部サービス依存

**GitHub**
- GitHub APIの安定稼働
- レート制限内での利用

**CDN・ホスティング**
- Vercelの安定稼働
- グローバルCDNの利用

## 5. リスクと対策

### 5.1 技術的リスク

**リスク: GitHub APIレート制限**
- 影響度: 高
- 発生確率: 中
- 対策: 
  - レート制限の監視と表示
  - キャッシュ機能の実装
  - 将来的な認証機能の追加検討

**リスク: パフォーマンス劣化**
- 影響度: 中
- 発生確率: 中
- 対策:
  - バンドルサイズの最適化
  - 画像最適化
  - コード分割の実装

**リスク: セキュリティ脆弱性**
- 影響度: 高
- 発生確率: 低
- 対策:
  - 定期的な依存関係の更新
  - セキュリティスキャンの実施
  -適切な入力値検証

### 5.2 ビジネスリスク

**リスク: GitHub API仕様変更**
- 影響度: 高
- 発生確率: 低
- 対策:
  - 公式ドキュメントの定期確認
  - バージョニング対応
  - フォールバック機能の実装

**リスク: 競合サービスの台頭**
- 影響度: 中
- 発生確率: 中
- 対策:
  - 独自機能の開発
  - ユーザビリティの向上
  - コミュニティフィードバックの活用

## 6. 品質保証

### 6.1 テスト要件（強化）

**ユニットテスト**
- カバレッジ: 85%以上（App Router対応）
- 重要なビジネスロジックは100%カバー
- Server Components と Client Components の分離テスト
- カスタムHooksの独立テスト
- ユーティリティ関数の完全テスト

**統合テスト**
- App Router API Routes のテスト
- Server/Client コンポーネント間の連携テスト
- 状態管理（Zustand）との統合テスト
- GitHub API との統合テスト
- エラーハンドリングの包括テスト

**E2Eテスト**
- 主要ユーザーフローの自動化テスト
- 検索〜詳細表示〜戻るの完全フロー
- 無限スクロールの動作テスト
- レスポンシブ対応のテスト
- クロスブラウザテスト（Chrome、Firefox、Safari）

**パフォーマンステスト**
- Lighthouse CI による継続的パフォーマンス監視
- Web Vitals の自動測定
- バンドルサイズの監視

### 6.2 品質基準

**コード品質**
- ESLint ルールに準拠
- TypeScript 型チェック100%
- コードレビューの実施

**アクセシビリティ**
- WCAG 2.1 AA レベル準拠
- キーボード操作対応
- スクリーンリーダー対応

## 7. 成功指標・KPI

### 7.1 技術指標

- **ページロード時間**: 平均3秒以内
- **検索レスポンス時間**: 平均2秒以内
- **エラー率**: 1%以下
- **稼働率**: 99.5%以上

### 7.2 ユーザビリティ指標

- **検索成功率**: 95%以上
- **詳細画面遷移率**: 60%以上
- **無限スクロール利用率**: 40%以上

---

**文書情報**
- 作成日: 2025-08-01
- 更新日: 2025-08-01
- バージョン: 1.0
- 承認者: [未承認]
